// Common.js
// Generated by Fminmaker.py, version 1.01 beta © RoyalMedia Ltd.
// Date: 2023-01-24 01:27
var keywords=new Object();var script_version=1;var default_timeout=100;var default_loader_timeout=300;var IsDebug=0;var IsDeepDebug=0;var IsTrace=0;var IsLog=0;var IsTraceCommit=0;var IsTraceRollback=0;var IsTraceErrorException=0;var IsForcedRefresh=0;var IsHideContextMenu=0;var IsAdmin=0;var IsOperator=0;var IsAssumeExchangeError=0;var IsXMLDump=0;var IsCleanBefore=1;var IsCheckImageTimeout=0;var IsTriggeredSubmit=0;var IsShowLoader=0;var IsActiveScroller=1;var IsWithoutProgress=0;var IsOptionRowspan=0;var IsNoDropdown=1;var IsSidebarEnabled=1;var IsMSIE=0;var is_webkit=0;var default_submit_mode=0;var default_action=null;var default_log_action=null;var default_print_action=null;var default_handler=null;var default_params=null;var default_input_name='';var should_be_updated=false;var current_context='';var placeholder='';var selected_menu_action=null;var selected_control=null;var semaphore_state=null;var treeview_state=null;var active_dialog=null;var loader_page='';var documents_dialog_active=1;var decrees_dialog_active=1;var TID=new Array();var LINE='';var SUBLINE='';var TABLINE='tabline';var REFERENCE='reference';var isWebServiceExecute=false;var isSubmitted=false;var isKeyboardDisabled=false;var isConfirmation=false;var isDropdownActive=false;var isCallback=false;var confirm_action='';var confirm_response=null;var DEFAULT_HTML_SPLITTER='_';var CSS_INVISIBLE='invisible';var schedule_documents=[0,0];var schedule_decrees=[0,0];var model=0;var root='';var back='';var baseURI='';var loaderURI='';var design_settings=new Object();var page_state=-1;var page_scroll_top=0;var is_loaded_success=false;var is_show_error=false;var is_link=false;var is_scroll_top=false;var is_on_refresh=false;var no_window_scroll=false;function interrupt(start,mode,timeout,callback,index,type){if(start){var i=!is_null(index)?index:TID.length;var delay=timeout?timeout:default_timeout;var func=function(){interrupt(false,mode,0,callback,i,type);};if(i==TID.length)TID.push(null);if(type==1)TID[i]=window.setInterval(func,delay);else TID[i]=window.setTimeout(func,delay);if(IsLog)console.log('start:'+mode+',index:'+i+',len:'+TID.length);}else if(mode){if(IsLog)console.log('interrupt:'+mode+',TID:'+TID.join('-'));if(mode==-1){if(!callback)callback='';window.location.replace(callback);}else if(mode==1){interrupt(false,0,0,null,index);$ShowOnStartup();}else if(mode==2){interrupt(false,0,0,null,index);$ReferenceDialog.submit('refresh');}else if(mode==3){interrupt(false,0,0,null,index);$LineSelector.onReset();}else if(mode==4){interrupt(false,0,0,null,index);$onClickTreeView();}else if(mode==5){interrupt(false,0,0,null,index);$SublineSelector._refresh(0);}else if(mode==9) $Semaphore.run(index);}else if(TID.length>index&&TID[index]!=null){if(type==1)window.clearInterval(TID[index]);else window.clearTimeout(TID[index]);if(index==TID.length-1)TID.splice(index,1);else TID[index]=null;if(IsLog)console.log('stop index:'+index+',len:'+TID.length);}}function beep(){var data="||uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs|ItAAAGDgYtAgAyN+QWaAAihwMWm4G8QQRDiMcCBcH3Cc+CDv|7xA4Tvh9Rz|y8QADBwMWgQAZG|ILNAARQ4GLTcDeIIIhxGOBAuD7hOfBB3|94gcJ3w+o5|5eIAIAAAVwWgQAVQ2ORaIQwEMAJiDg95G4nQL7mQVWI6GwRcfsZAcsKkJvxgxEjzFUgfHoSQ9Qq7KNwqHwuB13MA4a1q|DmBrHgPcmjiGoh||EwC5nGPEmS4RcfkVKOhJf+WOgoxJclFz3kgn||dBA+ya1GhurNn8zb||9NNutNuhz31f||||9vt|||z+IdAEAAAK4LQIAKobHItEIYCGAExBwe8jcToF9zIKrEdDYIuP2MgOWFSE34wYiR5iqQPj0JIeoVdlG4VD4XA67mAcNa1fhzA1jwHuTRxDUQ||iYBczjHiTJcIuPyKlHQkv|LHQUYkuSi57yQT||uggfZNajQ3Vmz+Zt||+mm3Wm3Q576v||||+32|||5|EOgAAADVghQAAAAA||uQZAUAB1WI0PZugAAAAAoQwAAAEk3nRd2qAAAAACiDgAAAAAAABCqEEQRLCgwpBGMlJkIz8jKhGvj4k6jzRnqasNKIeoh5gI7BJaC1A1AoNBjJgbyApVS4IDlZgDU5WUAxEKDNmmALHzZp0Fkz1FMTmGFl1FMEyodIavcCAUHDWrKAIA4aa2oCgILEBupZgHvAhEBcZ6joQBxS76AgccrFlczBvKLC0QI2cBoCFvfTDAo7eoOQInqDPBtvrDEZBNYN5xwNwxQRfw8ZQ5wQVLvO8OYU+mHvFLlDh05Mdg7BT6YrRPpCBznMB2r||xKJjyyOh+cImr2|4doscwD6neZjuZR4AgAABYAAAABy1xcdQtxYBYYZdifkUDgzzXaXn98Z0oi9ILU5mBjFANmRwlVJ3|6jYDAmxaiDG3|6xjQQCCKkRb|6kg|wW+kSJ5||rLobkLSiKmqP|0ikJuDaSaSf|6JiLYLEYnW|+kXg1WRVJL|9EmQ1YZIsv|6Qzwy5qk7|+tEU0nkls3|zIUMPKNX|6yZLf+kFgAfgGyLFAUwY||uQZAUABcd5UiNPVXAAAApAAAAAE0VZQKw9ISAAACgAAAAAVQIygIElVrFkBS+Jhi+EAuu+lKAkYUEIsmEAEoMeDmCETMvfSHTGkF5RWH7kz|ESHWPAq|kcCRhqBtMdokPdM7vil7RG98A2sc7zO6ZvTdM7pmOUAZTnJW+NXxqmd41dqJ6mLTXxrPpnV8avaIf5SvL7pndPvPpndJR9Kuu8fePvuiuhorgWjp7Mf|PRjxcFCPDkW31srioCExivv9lcwKEaHsf|7ow2Fl1T|9RkXgEhYElAoCLFtMArxwivDJJ+bR1HTKJdlEoTELCIqgEwVGSQ+hIm0NbK8WXcTEI0UPoa2NbG4y2K00JEWbZavJXkYaqo9CRHS55FcZTjKEk3NKoCYUnSQ0rWxrZbFKbKIhOKPZe1cJKzZSaQrIyULHDZmV5K4xySsDRKWOruanGtjLJXFEmwaIbDLX0hIPBUQPVFVkQkDoUNfSoDgQGKPekoxeGzA4DUvnn4bxzcZrtJyipKfPNy5w+9lnXwgqsiyHNeSVpemw4bWb9psYeq||uQZBoABQt4yMVxYAIAAAkQoAAAHvYpL5m6AAgAACXDAAAAD59jblTirQe9upFsmZbpMudy7Lz1X1DYsxOOSWpfPqNX2WqktK0DMvuGwlbNj44TleLPQ+Gsfb+GOWOKJoIrWb3cIMeeON6lz2umTqMXV8Mj30yWPpjoSa9ujK8SyeJP5y5mOW1D6hvLepeveEAEDo0mgCRClOEgANv3B9a6fikgUSu|DmAMATrGx7nng5p5iimPNZsfQLYB2sDLIkzRKZOHGAaUyDcpFBSLG9MCQALgAIgQs2YunOszLSAyQYPVC2YdGGeHD2dTdJk1pAHGAWDjnkcLKFymS3RQZTInzySoBwMG0QueC3gMsCEYxUqlrcxK6k1LQQcsmyYeQPdC2YfuGPASCBkcVMQQqpVJshui1tkXQJQV0OXGAZMXSOEEBRirXbVRQW7ugq7IM7rPWSZyDlM3IuNEkxzCOJ0ny2ThNkyRai1b6ev||3dzNGzNb||4uAvHT5sURcZCFcuKLhOFs8mLAAEAt4UWAAIABAAAAAB4qbHo0tIjVkUU||uQZAwABfSFz3ZqQAAAAAngwAAAE1HjMp2qAAAAACZDgAAAD5UkTE1UgZEUExqYynN1qZvqIOREEFmBcJQkwdxiFtw0qEOkGYfRDifBui9MQg4QAHAqWtAWHoCxu1Yf4VfWLPIM2mHDFsbQEVGwyqQoQcwnfHeIkNt9YnkiaS1oizycqJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l||8elePK|Lf||IInrOF|FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j|12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf|pD6ElLqSX+rUmOQNpJFa|r+sa4e|pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA||uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid|9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN|9Robv|Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV|YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI|gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a|EEBUdU1KrXLf40GoiiFXK|||qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd|+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt|WKi2N4d||uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF|Mg+0aohSIRobBAsMlO||Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W|rFRb|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=";var snd=new Audio("data:audio/wav;base64,"+data.replace(/^\|$/g,'/'));snd.play();}function $_mobile(){return $IS_FRAME==1?false:($IS_MOBILE?true:false);}function $_window_orientation(){return typeof(window.orientation) !== 'undefined'?(window.orientation==0||window.orientation==180?'portrait':'landscape'):(screen.msOrientation||screen.mozOrientation||(screen.orientation||{}).type);}function $_window_portrait(){return $_window_orientation().startswith('portrait');}function $_window_landscape(){return $_window_orientation().startswith('landscape');}function $_screen_with_scroll(mode,offset){if(['height','H'].indexOf(mode)>-1)return document.body.clientHeight+(offset||0)>$_height('available');return document.body.clientWidth+(offset||0)>$_width('available');}function $_get_css_size(value,x){return value.toString()+(x?x:"px");}function $_screen_center(mode){var m=mode||'available';return{'W':$_width(m),'H':$_height(m) };}function $_height(m){var f=$_mobile();if(m=='screen-max')return Math.max(window.screen.availHeight,verge.viewportH());if(m=='screen-min'||m=='mobile')return Math.min(window.screen.availHeight,verge.viewportH());if(m=='max')return Math.max(verge.viewportH(),window.screen.height,window.screen.availHeight,document.body.clientHeight,document.documentElement.clientHeight,window.innerHeight,window.outerHeight);if(m=='available'&&f){var mode=$_window_portrait()?'screen-max':'client';return $_height(mode);}if(m=='client'||m=='available')return document.documentElement.clientHeight||$_height('screen-min');else return Math.min(verge.viewportH(),window.screen.height,window.screen.availHeight,document.body.clientHeight,document.documentElement.clientHeight,window.innerHeight,window.outerHeight);}function show_height(){alert(joinToPrint(['height:','viewport:',verge.viewportH(),document.documentElement.clientHeight,'screen:',window.screen.height,'avail:',window.screen.availHeight,'client:',document.body.clientHeight,document.documentElement.scrollHeight,document.body.offsetHeight,'inner-outer:',window.innerHeight,window.outerHeight,' max:', $_height('max') ]));}function show_width(){alert(joinToPrint(['width:','viewport:',verge.viewportW(),document.documentElement.clientWidth,'screen:',window.screen.width,'avail:',window.screen.availWidth,'client:',document.body.clientWidth,document.documentElement.scrollWidth,document.body.offsetWidth,'inner-outer:',window.innerWidth,window.outerWidth,' max:', $_width('max') ]));}function win_is_max_height(){return window.outerHeight>=window.screen.height&&document.documentElement.scrollHeight>=window.innerHeight&&verge.viewportH()==window.innerHeight;}function $_width(m){var f=$_mobile();if(m=='screen-max')return Math.max(window.screen.availWidth,verge.viewportW());if(m=='screen-min'||m=='mobile')return Math.min(window.screen.availWidth,verge.viewportW());if(m=='max')return Math.max(verge.viewportW(),window.screen.width,window.screen.availWidth,document.body.clientWidth,document.documentElement.clientWidth);if(m=='available'&&f){var mode='screen-max';return $_width(mode);}if(m=='client'||m=='available')return document.documentElement.clientWidth;else return Math.min(verge.viewportW(),window.screen.width,window.screen.availWidth,document.body.clientWidth,document.documentElement.clientWidth);}function $_get_item_id(ob,index){var x=(is_exist(ob)&&ob.attr('id'))||0;var id=(x&&x.indexOf(DEFAULT_HTML_SPLITTER)>-1&&x.startswith('row'))?x.split(DEFAULT_HTML_SPLITTER):x;if(index<0){return id.slice(1,index).join(DEFAULT_HTML_SPLITTER);}return id[index||1]||id;}function $_get_item_number(ob,index){var x=(!is_empty(ob)&&ob.attr('id'))||0;var id=(x&&x.indexOf(DEFAULT_HTML_SPLITTER)>-1&&x.startswith('row'))?x.split(DEFAULT_HTML_SPLITTER):x;var num=0;if(index){if(index==-1||index>1){num=id.slice(index);}else{num=id.slice(1);}}else{num=id;}return num;}function $_maximize(){window.moveTo(0,0);window.resizeTo($_width('max'), $_height('max'));}function $_set_body_value(id,value){$("#"+id).each(function(){$(this).val(value);});}function $_box_position(ob,id){var scrolltop=int($(window).scrollTop());var p={top:0,left:0,height:0,width:0};if(is_null(ob)){if(IsDebug)alert("$_box_position:object is undefined!"+id);return p;}var c=ob.get(0).getBoundingClientRect();p.top=c.top+scrolltop;p.left=c.left;p.height=ob.height();p.width=ob.width();return p;}function $_show_window_in_center(container,mode,without_scroll){var page=$("#html-container");var sh=20;var sw=0;var center=$_screen_center(mode);var top=int((center.H-container.height())/2)-sh;var left=int((center.W-container.width())/2)-sw;if($_screen_with_scroll('H')&&is_null(without_scroll))top+=$(window).scrollTop();container .css('top', $_get_css_size(top)).css('left', $_get_css_size(left)) .show();}function $_init(){is_webkit=!(isIE||IsMSIE)?true:false;var ratio=window.devicePixelRatio;design_settings={'dialog' :{'body_default_width':1280,'offset_height':8,'top':40,'container_limit_height':800,'scrool_width':16,'window_ratio':(ratio>1?ratio:1),}};$Images.init();$MenuSelector.init(current_context);}function $_change_location(state,url){window.history.pushState(state,'');window.location.replace(url);}function $onImagesPreload(){$ShowPageSubmitMessages();$Init();if(typeof($_show_page) === 'function')return;$ShowPage(0);}function $onMenuSelect(ob){var url=ob.prop("href");if(!is_empty(url))window.location.replace(url);}function $CurrentContext(){return current_context||'default';}function $ShowPage(disable){if(disable===null)return;var startup_page_container=$("#html-container");if(disable)startup_page_container.hide();else startup_page_container.removeClass("hidden").show();}function $ShowOnStartup(){selected_menu_action=default_log_action;$Handle(selected_menu_action,default_handler,default_params);}function $ShowSubline(action){selected_menu_action=!is_null(action)?action:default_log_action;$Go(selected_menu_action);}function $ShowPageSubmitMessages(){function _get_object(id){var ob=$("#"+id);return is_exist(ob)?ob.val():null;}var errors=_get_object('errors');var OK=_get_object('OK');if(!is_empty(errors)) $ShowError(errors,true,true,false);else if(!is_empty(OK)) $NotificationDialog.open(OK);}function $ShowSystemMessages(reset,error){}function $TriggerActions(disable){if(IsTriggeredSubmit&&default_submit_mode==0) $ShowPage(disable);}function $ShowError(msg,is_ok,is_error,is_session_close){if(is_show_error||!msg)return;if(!is_null(active_dialog))active_dialog.dialog("option","closeOnEscape",false);var container=$("#error-container");$("#error-text").html(msg);if(is_ok){$("#error-button").append( '<button id="error-button-ok" class="ui-button-text" onclick="javascript:$HideError();">'+keywords['OK']+'</button>' );}if(is_error)container.removeClass("warning").addClass("error");else container.removeClass("error").addClass("warning");$_show_window_in_center(container,null,true);is_show_error=true;$("#error-button-ok").focus();if(is_session_close&&!$IS_DEMO)interrupt(true, -1,5000,'',0);}function $HideError(){$("#error-container").hide();$("#error-button").html('');if(!is_null(active_dialog))active_dialog.dialog("option","closeOnEscape",true);is_show_error=false;$SetFocus();}function $ShowLoader(start){if(is_show_error)return;if(start){var loader=$("#page-loader");var container=$("#html-container");if(start==-1){isWebServiceExecute=false;if(IsShowLoader)loader.hide();else container.removeClass("inprogress");$InProgress(null);}else{isWebServiceExecute=true;if(IsShowLoader) $_show_window_in_center(loader,'available');else container.addClass("inprogress");}}}function $ActivateInfoData(show){var container=$("#info-data");if(is_null(container))return;if(show)container.show();else{container.hide();return;}$PageScroller.reset(true);}function $RemoveInfoData(){var container=$("#info-data");if(is_null(container))return;container.empty().hide();}function $InProgress(ob,mode){if(IsWithoutProgress)return;if(!is_null(ob)&&mode==1){ob.addClass("inprogress");selected_control=ob;}else if(!is_null(selected_control)){selected_control.removeClass("inprogress");selected_control=null;}}function $SetFocus(ob) {}var flash_timer=null;function $HideFlash(){if(!is_null(flash_timer)){clearTimeout(flash_timer);flash_timer=null;}$("#page_flash_section") .addClass('hidden');}function $AddFlash(message,css,timeout,callback){if(is_empty(message))return;if(is_empty(css))css='flash';var container=$("#page_flash_section");container.html('');container.append('<div class="'+css+'">'+message+'</div>');container.removeClass('hidden');if(is_empty(timeout))return;if(timeout>0)flash_timer=setTimeout(function(){$HideFlash();callback();},timeout);}function $ResetSearch(deactivate){if(deactivate) $_deactivate_search();var search=$("#search-context");if(search.val()){var src=$SCRIPT_ROOT+'/static/img/';if(is_search_activated){$("#search-icon") .attr('title',keywords['Cancel search']) .attr('src',src+'db-close.png');}else{$("#search-icon") .attr('title',keywords['Search']) .attr('src',src+'db-search.png');search.val('');}}}function $HideLogPage(){var ob=SelectedGetItem(SUBLINE,'ob');if(IsLog)console.log('$HideLogPage:'+is_null(ob));if(!is_null(ob)) $onToggleSelectedClass(SUBLINE,ob,'remove',null);}function $ShowLogPage(){var ob=SelectedGetItem(SUBLINE,'ob');if(IsLog)console.log('$ShowLogPage:'+is_null(ob));if(!is_null(ob)) $onToggleSelectedClass(SUBLINE,ob,'add',null);if(is_scroll_top){$(window).scrollTop(0);is_scroll_top=false;}}function $ResetLogPage(){$("#command").each(function(){$(this).val('');});}function $Go(action){if(IsLog){console.log('$Go.action',action);}$web_logging(action);}function $Handle(action,handler,params){if(IsLog){console.log('$Handle.action:',action,handler,params);}$web_logging(action,handler,params);}function $onParentFormSubmit(id){var frm=$("#"+(id||'filter-form'));var action=frm.attr('action');$SidebarControl.onBeforeSubmit();var is_run=1;try{is_run=performance.navigation.type==0?1:0;}catch(err) {}if(IsDeepDebug)alert('$onParentFormSubmit.begin:'+id+':'+[is_run,action].join(':'));if(is_run) $("#OK",frm).val('run');var ob=$("#window_scroll",frm);var top=is_on_refresh?page_scroll_top:$(window).scrollTop();if(is_exist(ob))ob.val(!no_window_scroll?top:'');if(IsDeepDebug)alert('$onParentFormSubmit.end:'+frm.attr('id')+':'+ob.val()+':'+top);frm.submit();}function $onLineFormSubmit(){if(IsLog)console.log('$onLineFormSubmit:'+default_submit_mode);switch(default_submit_mode){case 0: $onParentFormSubmit();break;case 1:case 2: $Handle(default_action,default_handler,default_params);break;}}function $onPageLinkSubmit(link){var x=link.split('?');var url=x[0];var qs=x.length>1?strip(x[1]):'';var sidebar=$_mobile()?0:$SidebarControl.get_state();url=url+makeLocation(qs,'sidebar',sidebar);window.location.replace(url);}function $onToggleSelectedClass(key,ob,action,command,force){var id=null;var tag='TR';if(is_exist(ob)){id=$_get_item_id(ob);tag=ob[0].tagName;}else{id=SelectedGetItem(key,'id');}var mask=([LINE,SUBLINE,TABLINE,REFERENCE].indexOf(key)>-1||tag=='TR')?'td':'dd';var input="input[name^='"+default_input_name+"']";if(IsLog)console.log('$onToggleSelectedClass:',key,'id['+id+']','action:',action,'mask:',mask,'ob:',ob,tag);if(is_null(id))return;if(is_null(ob))ob=SelectedGetItem(key,'ob');function make(ob,action,mode){if(is_null(ob))return;if(IsLog)console.log('$onToggleSelectedClass.make:'+action+':'+id);$(mask,ob).each(function(){if(IsLog)console.log('$onToggleSelectedClass',key,ob,action, $(this));if(IsOptionRowspan&&($(this).hasClass("noselected")||$(this).prop('rowspan')>1)) $.noop();else if(action=='add'){$(this).addClass("selected");if(key==LINE&&mode==1) $(input).each(function(){$(this).val(id);});}else{$(this).removeClass("selected");}});if(action=='add'){ob.addClass("selected");SelectedSetItem(key,'ob',ob);}else{ob.removeClass("selected");SelectedSetItem(key,'ob',null);}} $("#command").val(!is_null(command)?command:'');switch(action){case 'submit':if(isWebServiceExecute||key!=LINE)return;$(input).each(function(){$(this).val(id);});if(force){$onParentFormSubmit();return;}if(default_submit_mode>0){make(SelectedGetItem(key,'ob'),'remove',0);SelectedReset();make(ob,'add',0);}$onLineFormSubmit();break;case 'clean': $(input).each(function(){$(this).val('');});SelectedSetItem(key,'ob',null);break;default:make(ob,action,1);}}function $setPaginationFormSubmit(page){$("input[name='page']").each(function(){$(this).val(is_null(page)?'1':page.toString());});}function $onOpenHelp(){$HelpDialog.open();return true;}function $onRefreshClick(command){$("#command").val(command||'refresh');$onParentFormSubmit();}function $onResetClick(){$("#command").val('init-filter');var link=window.location.toString();var x=link.split('?');var url=x[0];var qs=x.length>1?strip(x[1]):'';var sidebar=$SidebarControl.get_state();url=url+makeLocation('','sidebar',sidebar);$("form#init-form").attr('action',url);$onParentFormSubmit('init-form');}function $onExportClick(){$("#command").val('export');$onParentFormSubmit();}function $onControlPanelClick(ob){if(isDropdownActive)return;var id=ob.attr('id');var dropdown=(id=="admin-panel-dropdown"?$("#admin-panel"):(id=="services-dropdown"?$("#services"):(id=="actions-dropdown"?$("#actions"):null)));if(is_null(dropdown))return;var dropdown_id=dropdown.attr('id');var is_selected=!(is_null(selected_dropdown)||selected_dropdown[0].attr('id')==dropdown_id);isDropdownActive=true;if(is_selected)selected_dropdown[0].slideToggle('slow');dropdown.slideToggle('slow',function(){isDropdownActive=false;});var is_closed=!is_null(selected_dropdown)&&selected_dropdown[1]==dropdown_id;selected_dropdown=is_closed?null:new Array(dropdown,dropdown_id);}if(IsHideContextMenu==1||IsHideContextMenu==2){if(document.addEventListener){document.addEventListener('contextmenu',function(e){e.preventDefault();},false);}if(IsHideContextMenu==2){document.attachEvent('oncontextmenu',function(){alert("You've tried to open context menu after");window.event.returnValue=false;});}}jQuery(function($){$("li.dropdown").on('click',function(e){cls='open';if(!IsNoDropdown){var ob=$(this);if(!ob.hasClass(cls))ob.addClass(cls);else ob.removeClass(cls);}});$("li.dropdown").on("mouseleave",function(e){cls='open';if(IsNoDropdown){var ob=$(this);if(ob.hasClass(cls))ob.removeClass(cls);}});$("#sidebar-navigator").click(function(e){var ob=$(this);if(is_null($SidebarDialog)||!$SidebarDialog.is_active){$SidebarControl.onNavigatorClick(false);}else{$SidebarDialog.activate(ob);}});$("#sidebarFrame").on("mouseover",function(e){$SidebarControl.onFrameMouseOver();e.stopPropagation();}).on("mouseout",function(e){if($_mobile()||$(this).has(e.target).length==0) $SidebarControl.onFrameMouseOut();e.stopPropagation();});$("#sidebarMobilePointer").click(function(e){$SidebarControl.onFrameMouseOver();});$("#sidebarPointer").click(function(e){$SidebarControl.onActivatePointer($(this));e.stopPropagation();});$("a.mainmenu").click(function(e){var link=$(this).prop('href');var target=$(this).prop('target');if(is_empty(target)){$onPageLinkSubmit(link,target);e.preventDefault();return false;}return true;});$("#refresh").click(function(e){$onRefreshClick();e.preventDefault();});$("#init-filter").click(function(e){$onResetClick();e.preventDefault();});$("#export").click(function(e){$onExportClick();e.preventDefault();});$("#back").click(function(e){window.location.replace(back||root);e.preventDefault();});$("#reload").click(function(e){window.location.reload();e.preventDefault();});$("div[id^='history']",this).click(function(e){var id=$(this).attr('id');if(id=='history:forward')window.history.forward();else if(id=='history:back'){if(window.history.length>0)window.history.back();}else if(typeof history_callback=== 'function')history_callback(id);});function $onSearchSubmit(e){var s=strip($("#search-context").val());$ResetLogPage();if(is_search_focused||is_null(e)){search_context=s;$("#search-context").val(s);if(is_empty(s)) $("input[id='reset_search']").each(function(){$(this).val('1');});else $("input[id='searched']").each(function(){$(this).val(s);});$LineSelector.onFormSubmit();$setPaginationFormSubmit(1);$onParentFormSubmit('filter-form');}} $("#search-context").focusin(function(e){is_search_focused=true;}).focusout(function(e){is_search_focused=false;});$("#search-icon").click(function(e){$onSearchSubmit(null);$onParentFormSubmit('filter-form');});$("#search-form").submit(function(e){$onSearchSubmit(e);});$(".dropdown-link").click(function(e){$onControlPanelClick($(this));e.preventDefault();});$("#schedule-refresh").click(function(e){$SidebarControl.onRefreshPointer($(this));e.preventDefault();});$("#schedule-close").click(function(e){$SidebarControl.onActivatePointer($(this));e.preventDefault();});$(window).focus(function(){if(is_on_refresh)return;page_scroll_top=$(window).scrollTop();if(typeof($_activate) === 'function'&&$_activate(1)){is_on_refresh=true;$HideError();$ShowPage(1);$onRefreshClick();}else $Semaphore.start(true);}).blur(function(){$Semaphore.stop(false);});$(window).on("resize",function(){$SidebarControl.resize();});$("a.page").click(function(e){var link=$(this).prop('href');$onPageLinkSubmit(link);e.preventDefault();return false;});$(window).keydown(function(e){var exit=false;if(e.keyCode==116){$onRefreshClick();exit=true;}if(e.shiftKey&&e.keyCode==112)exit=$onOpenHelp();if($ConfirmDialog.is_focused()||$NotificationDialog.is_focused()||page_is_focused(e)||isKeyboardDisabled)return;try{if($BaseDialog.is_focused()||is_search_focused)return;}catch(err){alert('common exception:is_focused');return;}if(e.shiftKey&&[67,79].indexOf(e.keyCode)>-1){if(!is_null($SidebarDialog)&&$SidebarDialog.is_active){if(IsSidebarEnabled) $SidebarControl.onNavigatorClick(false);exit=true;}else return;}else if(e.shiftKey&&e.keyCode==82){$onResetClick();exit=true;}else if(e.shiftKey&&e.keyCode==83){var focused=$("#search-context");$SidebarControl.onFrameMouseOver(focused);focused.focus();exit=true;}else if(e.shiftKey&&e.keyCode==77){var container=$("#messages_container");if(is_exist(container))container.toggleClass('hidden');exit=true;}else if(e.ctrlKey||e.shiftKey){if(isWebServiceExecute)return;if(e.keyCode==38)exit=$LineSelector.up();else if(e.keyCode==40)exit=$LineSelector.down();else if(e.ctrlKey&&e.keyCode==36)exit=$LineSelector.home();else if(e.shiftKey&&e.keyCode==33)exit=$LineSelector.pgup();else if(e.shiftKey&&e.keyCode==34)exit=$LineSelector.pgdown();else if(e.ctrlKey&&e.keyCode==35)exit=$LineSelector.end();else if(e.shiftKey&&e.keyCode==9)exit=$TabSelector.tab()||true;else if(e.ctrlKey&&e.keyCode==37)exit=$TabSelector.left();else if(e.ctrlKey&&e.keyCode==39)exit=$TabSelector.right();}else if(e.altKey){if(isWebServiceExecute)return;var before=true;if(typeof keyboard_alt_before=== 'function')before=keyboard_alt_before(e.keyCode);if(before){if(e.keyCode==38)exit=$ActiveSelector.up();else if(e.keyCode==40)exit=$ActiveSelector.down();else if([33,36].indexOf(e.keyCode)>-1)exit=$ActiveSelector.home();else if([34,35].indexOf(e.keyCode)>-1)exit=$ActiveSelector.end();}else exit=true;if(typeof keyboard_alt_after=== 'function'&&before)keyboard_alt_after(e.keyCode);}if(exit){e.preventDefault();return false;}});});function $web_semaphore(action){if(isWebServiceExecute||!$Semaphore.isEnabled())return;if(IsLog)console.log('web_semaphore:',action);$Semaphore.running();var args={'action':action,'template':$Semaphore.template,'lid':$Semaphore.lid, };$.post($SCRIPT_ROOT+'/semaphore/loader',args,function(x){var state=x['state'];$Semaphore.refresh(state);},'json') .fail(function(){$Semaphore.error();}) .always(function(){});}
